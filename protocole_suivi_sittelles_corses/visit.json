{
   "display_properties":[
      "id_base_site",
      "visit_date_min",
      "year",
      "statut_obs",
      "Occcomportement",
      "observers",
      "time_observation1",
      "time_observation2",
      "time_to_detection",
      "Couverture_Nuageuse",
      "Vent",
      "Temperature",
      "Pluie",
      "comments",
      "id_dataset"
      
   ],
   "display_list":[
      "id_base_site",
      "visit_date_min",
      "statut_obs"
   ],
   "specific":{
      "id_base_site":{
         "type_widget":"datalist",
         "attribut_label":"Site",
         "type_util":"site",
         "keyValue":"id_base_site",
         "keyLabel":"base_site_name",
         "api":"__MONITORINGS_PATH/list/__MODULE.MODULE_CODE/site?fields=id_base_site&fields=base_site_name",
         "params":[
            "({meta}) => ({",
            "id_module: __MODULE.ID_MODULE,",
            "id_sites_group: meta.parents.site && meta.parents.site.properties.id_sites_group,",
            "order_by: 'base_site_name*'",
            "})"
         ],
         "application":"GeoNature",
         "required":true,
         "hidden":"({meta, value}) => !meta.bChainInput && value.id_base_site"
      },
      "statut_obs":{
         "type_widget":"select",
         "attribut_label":"Contact",
         "values": ["Absent", "Present"],
         "required":true
      },
      "Occcomportement":{
         "attribut_label":"Comportement",
         "type_widget":"select",
         "values":[
            "Territorial",
            "Chant"
         ],
         "required":false,
         "hidden":"({value}) => value.statut_obs != 'Present'",
         "definition": "CR =  cri territorial, CH = chant"        
      },
      "visit_date_min":{
         "attribut_label":"Date",
         "required":true
      },
      "time_observation1":{
         "attribut_label":"Heure de debut",
         "type_widget":"time",
         "required": true
      },
      "time_observation2":{
         "attribut_label":"Heure de fin",
         "type_widget":"time",
         "required": true
      },
      "time_to_detection":{
         "attribut_label":"Temps de detection",
         "type_widget":"number",
         "min": -1,
         "max":10,
         "hidden":"({value}) => value.statut_obs != 'Present'"
      },
      "cd_nom":{
         "type_widget":"text",
         "attribut_label":"cd nom",
         "type_util":"taxonomy",
         "value":3772,
         "hidden":true
      },
      "nom_latin":{
         "type_widget":"text",
         "attribut_label": "Nom latin",
         "value": "Sitta Whiteheadi",
         "hidden": true
      },
      "Couverture_Nuageuse":{
         "type_widget":"select",
         "attribut_label":"Couverture nuageuse (%)",
         "values" : [0, 20, 40, 50, 60, 80 ,100],
         "required": true
      }, 
      "Vent":{
         "type_widget":"select",
         "attribut_label":"Vent",
         "values":[
            0,
            1,
            2,
            3
         ],
         "definition": "0 = nul, 1 = faible, 2 = moyen, 3 = fort",
         "required": true
      },
      "Temperature":{
         "type_widget":"select",
         "attribut_label":"Temperature",
         "values":[
            0,
            1,
            2
         ],
         "definition": "0 = froid, 1 = doux, 2 = chaud",
         "required": true 
      },
      "Pluie":{
         "type_widget":"select",
         "attribut_label":"Pluie",
         "values":[
            0,
            1,
            2
         ],
         "definition": "0 = nulle, 1 = faible, 2 = forte",
         "required": true
      },
      "comments":{
         "attribut_label":"Remarque",
         "type_widget":"text"
      },
      "year":{
         "attribut_label":"Annee",
         "type_widget":"text",
         "hidden":true
      }
   },   
        
   "change":[

          "({objForm, meta}) => {",
      "const year = objForm.value.visit_date_min.year",
      "if (!objForm.controls.year.dirty) {",
      "objForm.patchValue({year})",
      "}",
      "}",
      ""
      
   ]
}